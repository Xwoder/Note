# ThingsBoard 调研笔记-仪表板

[TOC]

## 创建

1. 进入[仪表板库](https://demo.thingsboard.io/dashboards)界面
2. 点击**添加仪表板**按钮
3. 输入仪表板的标题
4. 点击**添加**按钮

## 配置

1. 进入[仪表板库](https://demo.thingsboard.io/dashboards)菜单，右侧将显示已有仪表板
2. 点击其中的某个仪表板右侧的**打开仪表板**（`Dashboard details`）按钮，进入仪表盘画布界面
3. 点下右下角的**进入编辑模式**（`Enter edit mode`）按钮

### 配置别名

1. 点击顶部菜单栏目的**实体别名**按钮
2. 在弹出的**实体别名**对话框总，点击**添加别名**按钮
3. 输入别名，例如：`SHFT-我的仪表盘-别名`
4. 筛选器类型选择**单个实体**
5. 类型选择**设备**，在右侧的设备列表中选择已有的设备，例如：`SHFT-thermometers`
6. 点击**添加**按钮，返回上级**实体别名**对话框
7. 点击**保存**按钮
8. 关闭**实体别名**对话框

### 配置部件

1. 进入某个仪表盘的画布界面
2. 点击右下角的**进入编辑模式**按钮
3. 点击添加**新的部件**按钮
4. 选择某种的部件类型。例如：`Cards`
5. 选择某个部件。例如：`Simple cards`
6. 配置数据源
    1. 在数据标签中，点击添加按钮
    2. 在**类型**列表中选择实体；在**实体别名**列表中搜索并选择已有的实体别名；在**最新的数据键**（ `Latest data keys`）列表中查找并选择之前设备传入的遥测值的键，例如：`temperature`
    3. 点击**添加**按钮，返回仪表盘画布界面
7. 调整部件库大小和位置
8. 重复第 3~7 步，分别添加表格、图表和警报部件。

## 警报

#### 配置规则

> 对于警报部件需要特殊配置其警报规则

报警条件通过**设备配置**（`Device profiles`）得以确定，建议为每个相应的设备类型创建专用的设备配置。

> 下面的操作以创建一个名为`SHFT-temperature-high`报警规则为例，该报警规则的当键为`temperature`的遥测数据的值超过某一指定数值时被触发。

1. 进入[设备配置](https://demo.thingsboard.io/deviceProfiles)界面
2. 在设备配置列表界面，点击 `default` 设备配置，弹出设备**配置详情**面板
3. 点击**报警规则**标签
4. 点击右侧的**切换编辑模式**按钮
5. 点击**添加报警规则**按钮
6. 在**报警类型**中填入报警类型；例如：`SHFT-temperature-high`
7. 在创建报警规则中，选择严重程度；点击右侧的条件文本标签右侧的**请添加报警规则条件**按钮，弹出**编辑报警规则条件**对话框
8. 点击**添加键名筛选器**按钮，弹出**添加键名筛选器**对话框
    1. **键类型**选择**时间序列**（`Timeseries`）；
    2. 在键名列表中选择设备传入的遥测数据的键名，例如：`temperature`；
    3. 选择恰当的值类型，例如：数字
    4. 展开筛选器面板
        1. 点击**添加**按钮
        2. 在操作列表中选择一个逻辑运算；例如：大于或等于
        3. 在值文本框中输入一个恰当的值，从而跟左侧的逻辑运算符构成一个合理的逻辑表达式；例如：30
    5. 点击**添加键名筛选器**对话框的**添加**按钮
    6. 选择恰当的条件类型；例如：简单
    7. 在编辑报警规则条件对话框中点击**保存**按钮
    8. 点击设备配置详情面板右上角的应用更改按钮

#### 触发

可以通过代替设备发送 `HTTP` 请求，以传入一个过高的温度，从而触发之前设置的警告。例如：

```bash
curl \
--location \
--request POST 'https://demo.thingsboard.io/api/v1/1A454k3ud3X5if86sCQK/telemetry' \
--header 'Content-Type: application/json' \
--data-raw '{
    "temperature": 40
}'
```

#### 通知

警报支持通过 `E-mail` 和  `SMS` 的方式通知。

配置过程：略

## 客户用户分配

略
